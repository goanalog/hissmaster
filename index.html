<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Tape Loop Lab</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>
        Tape Loop Lab
        <span>cassette-inspired live loop sandbox</span>
      </h1>
    </header>

    <main class="workzone">
      <section class="cassette-shell">
        <div class="cassette-header">
          <div>virtual cassette ✶ live path</div>
          <div id="statusText">status: <span style="color:var(--accent)">stopped</span></div>
        </div>
        <div class="cassette-stage">
          <svg id="cassetteSVG" viewBox="0 0 800 350" xmlns="http://www.w3.org/2000/svg">
            <rect x="20" y="20" width="760" height="310" rx="16" ry="16" fill="#111" stroke="#444" stroke-width="3" />
            <rect x="40" y="40" width="720" height="180" rx="8" ry="8" fill="#1a1a1a" stroke="#555" stroke-width="2" />
            <rect x="200" y="70" width="400" height="120" rx="8" ry="8" fill="#0a0a0a" stroke="#777" stroke-width="2" />
            <g id="tapeLayer">
              <path id="tapeBase" class="tape-base" d="" />
              <path id="tapeMotion" class="tape-motion" d="" />
              <path id="tapeActive" class="tape-active" d="" />
            </g>
            <g id="leftReel" transform="translate(275,130)">
              <circle class="reel" r="55" />
              <circle class="reel-center" r="10" />
              <line class="reel-arm" x1="0" y1="0" x2="0" y2="-45" />
              <line class="reel-arm" x1="0" y1="0" x2="38.97" y2="22.5" />
              <line class="reel-arm" x1="0" y1="0" x2="-38.97" y2="22.5" />
            </g>
            <g id="rightReel" transform="translate(525,130)">
              <circle class="reel" r="55" />
              <circle class="reel-center" r="10" />
              <line class="reel-arm" x1="0" y1="0" x2="0" y2="-45" />
              <line class="reel-arm" x1="0" y1="0" x2="38.97" y2="22.5" />
              <line class="reel-arm" x1="0" y1="0" x2="-38.97" y2="22.5" />
            </g>
            <g id="sprocketLayer"></g>
            <g id="headLayer"></g>
          </svg>
        </div>
      </section>

      <aside class="sidepanel">
        <div class="section-label">
          <span>Transport</span>
          <span id="dirText">→ fwd</span>
        </div>
        <div class="transport-row">
          <button class="btn-transport" id="btnPlay">PLAY</button>
          <button class="btn-transport" id="btnStop">STOP</button>
          <button class="btn-transport" id="btnReverse">REV</button>
        </div>

        <div class="section-label">
          <span>Tape Speed</span>
          <span id="speedMeta">7.50 ips</span>
        </div>
        <div class="speed-wrap">
          <input
            id="speedRange"
            type="range"
            min="1.875"
            max="15"
            step="0.125"
            value="7.5"
          />
          <div class="speed-value">
            <span id="speedVal">7.50</span>
            <span class="speed-unit">ips</span>
          </div>
        </div>
        <div class="speed-readouts">
          <div>
            pitch shift: <span id="pitchShift">0.0</span> st
          </div>
          <div>
            loop repeats every <span id="loopDuration">0.00</span> s
          </div>
        </div>

        <div class="section-label">
          <span>Low Cut</span>
          <span id="toneCutLabel">90 Hz</span>
        </div>
        <div class="tone-wrap">
          <input
            id="toneCutRange"
            type="range"
            min="20"
            max="1000"
            step="1"
            value="90"
          />
        </div>

        <div class="section-label">
          <span>Loop Physics</span>
          <span id="pathSummary">0.0 in</span>
        </div>
        <div class="physics-grid">
          <div class="metric-block">
            <div class="metric-label">physical path</div>
            <div class="metric-value" id="loopLength">0.0 in</div>
            <div class="metric-note">drag posts to redraw</div>
          </div>
          <div class="metric-block">
            <div class="metric-label">guides engaged</div>
            <div class="metric-value" id="sprocketCount">2</div>
            <div class="metric-note">more = extra flutter</div>
          </div>
        </div>

        <div class="section-label">
          <span>Audio Source</span>
          <span id="sampleName">no sample</span>
        </div>
        <div class="file-block">
          <input type="file" id="fileInput" accept="audio/*" />
          <button type="button" id="btnMicSample">sample mic</button>
        </div>

        <div class="section-label">
          <span>Tape Path</span>
          <span><span style="color:var(--accent)">drag</span> nodes</span>
        </div>
        <div class="sprocket-row">
          <button id="btnAddSprocket">+ add post</button>
          <button id="btnRemoveSprocket" class="btn-danger">- remove last</button>
        </div>

        <div class="section-label">
          <span>Heads &amp; Echo</span>
          <span id="headDelaySummary">0.00 s</span>
        </div>
        <div class="head-controls">
          <label class="slider-label" for="headDistanceRange">record → play distance</label>
          <input
            id="headDistanceRange"
            type="range"
            min="0"
            max="36"
            step="0.25"
            value="12"
          />
          <div class="head-stats">
            <span><span id="headDistanceVal">12.0</span> in</span>
            <span>wow bias <span id="wowBias">1.0×</span></span>
          </div>
          <label class="slider-label" for="feedbackRange">feedback</label>
          <input
            id="feedbackRange"
            type="range"
            min="0"
            max="0.85"
            step="0.01"
            value="0.35"
          />
          <div class="head-stats">
            <span>feedback <span id="feedbackVal">35%</span></span>
            <span>delay <span id="headDelay">0.00</span> s</span>
          </div>
        </div>
      </aside>
    </main>

    <footer>
      Tape Loop Lab — play, reverse, stretch, and bruise audio like a cassette. This is an experiment.<br />
      transport buttons glow when active • reels spin in sync • wow/flutter &amp; EQ give <span>warmth</span>
    </footer>

    <script src="script.js"></script>
  </body>
</html>
